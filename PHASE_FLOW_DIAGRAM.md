# Two-Phase Flow - Visual Diagram

## Timeline View

```
TIME â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’

USER          LOGIN              PHASE 1             STATE         PHASE 2
STARTS        RUNS               RUNS               SELECTION      RUNS
  â”‚             â”‚                  â”‚                    â”‚             â”‚
  â–¼             â–¼                  â–¼                    â–¼             â–¼
â”Œâ”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Yes,â”‚      â”‚Gateway â”‚         â”‚Content  â”‚         â”‚Select  â”‚   â”‚Dockets  â”‚
â”‚Go! â”‚ â”€â”€â”€> â”‚  IAC   â”‚ â”€â”€â”€â”€â”€>  â”‚Types +  â”‚ â”€â”€â”€â”€â”€>  â”‚State:  â”‚â”€â”€>â”‚by State â”‚
â”‚    â”‚      â”‚WestLaw â”‚         â”‚Dockets  â”‚         â”‚CA/NY/TXâ”‚   â”‚+ State  â”‚
â””â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             (automatic)     (on user confirm)   (user choice)  (automatic)

                                  â†‘                                  â†‘
                           User clicks here                   User clicks here
                         "Yes, Select Docket"                   "California"
```

## Phase Breakdown

### ğŸš€ Phase 1: Content Types â†’ Dockets

**When**: User clicks "Yes, Select Docket"

**What happens**:
```
   User Action
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Click "Yes,      â”‚
â”‚ Select Docket"   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”„ Spinner appears:                 â”‚
â”‚  "Executing Content Types â†’          â”‚
â”‚   Dockets..."                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend Automation:                 â”‚
â”‚                                      â”‚
â”‚  1. Find "Content Types" tab         â”‚
â”‚     Try 3 different selectors        â”‚
â”‚     ğŸ“¸ Screenshot                    â”‚
â”‚                                      â”‚
â”‚  2. Click "Content Types"            â”‚
â”‚     ğŸ“¸ Screenshot                    â”‚
â”‚                                      â”‚
â”‚  3. Find "Dockets" option            â”‚
â”‚     Try 4 different selectors        â”‚
â”‚     ğŸ“¸ Screenshot                    â”‚
â”‚                                      â”‚
â”‚  4. Click "Dockets"                  â”‚
â”‚     ğŸ“¸ Screenshot                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… Success message shown             â”‚
â”‚  "Successfully navigated to           â”‚
â”‚   Content Types â†’ Dockets!"          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UI shows state selection:           â”‚
â”‚                                      â”‚
â”‚  ğŸ“‚ Dockets by State                 â”‚
â”‚  Please select a state:              â”‚
â”‚                                      â”‚
â”‚  [ğŸ“„ California]                     â”‚
â”‚  [ğŸ“„ New York]                       â”‚
â”‚  [ğŸ“„ Texas]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ¯ Phase 2: Dockets by State â†’ California

**When**: User clicks "California"

**What happens**:
```
   User Action
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Click            â”‚
â”‚ "California"     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”„ Spinner appears:                 â”‚
â”‚  "Navigating: Dockets by State â†’     â”‚
â”‚   California..."                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend Automation:                 â”‚
â”‚                                      â”‚
â”‚  1. Find "Dockets by State"          â”‚
â”‚     ğŸ“¸ Screenshot                    â”‚
â”‚                                      â”‚
â”‚  2. Click "Dockets by State"         â”‚
â”‚     ğŸ“¸ Screenshot                    â”‚
â”‚                                      â”‚
â”‚  3. Wait 3 seconds for page load     â”‚
â”‚                                      â”‚
â”‚  4. Find "California" link           â”‚
â”‚     Try 5 different selectors:       â”‚
â”‚     - //a[text()="California"]       â”‚
â”‚     - //a[contains(...)]             â”‚
â”‚     - //*[@href and contains(...)]   â”‚
â”‚     - //*[text()="California"]       â”‚
â”‚     - //*[contains(...)]             â”‚
â”‚     ğŸ“¸ Screenshot                    â”‚
â”‚                                      â”‚
â”‚  5. Scroll "California" into view    â”‚
â”‚     ğŸ“¸ Screenshot                    â”‚
â”‚                                      â”‚
â”‚  6. Click "California"               â”‚
â”‚     ğŸ“¸ Screenshot                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… Task done                         â”‚
â”‚  Selected State Docket: California   â”‚
â”‚                                      â”‚
â”‚  [ğŸ”„ Run Again]  [ğŸšª Exit]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## State Machine View

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CHATBOT STATE MACHINE                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    START
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  IDLE    â”‚ â”€â”€â”€â”€[User: Yes, Let's Go!]â”€â”€â”€> RUN_LOGIN
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
                                                  â”‚
                                                  â–¼
                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                         â”‚ LOGIN_RUNNING   â”‚
                                         â”‚  - Gateway      â”‚
                                         â”‚  - IAC          â”‚
                                         â”‚  - WestLaw      â”‚
                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                                                  â–¼
                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                         â”‚ LOGIN_COMPLETE  â”‚
                                         â”‚ Prompt user     â”‚
                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚                                                         â”‚
          [User: Yes, Select Docket]                              [User: No, Exit]
                     â”‚                                                         â”‚
                     â–¼                                                         â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  PHASE_1        â”‚                                        â”‚   EXIT   â”‚
            â”‚  RUNNING        â”‚                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚ - Content Types â”‚
            â”‚ - Dockets       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ PHASE_1         â”‚
            â”‚ COMPLETE        â”‚
            â”‚ Show states     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”œâ”€â”€[User: California]â”€â”€> â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚                        â”‚  PHASE_2        â”‚
                     â”‚                        â”‚  RUNNING        â”‚
                     â”œâ”€â”€[User: New York]â”€â”€â”€>  â”‚ - Dockets by    â”‚
                     â”‚                        â”‚   State         â”‚
                     â”œâ”€â”€[User: Texas]â”€â”€â”€â”€â”€>   â”‚ - Click State   â”‚
                     â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                                 â”‚
                     â–¼                                 â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  [Back]     â”‚                   â”‚ COMPLETED       â”‚
            â”‚  Return to  â”‚                   â”‚                 â”‚
            â”‚  Login Page â”‚                   â”‚ [Run Again]     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚ [Exit]          â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Session State Flow

```
Session State Variables:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      VARIABLE       â”‚   INITIAL    â”‚ AFTER LOGIN  â”‚ AFTER PHASE1 â”‚ AFTER PHASE2 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ started             â”‚    False     â”‚     True     â”‚     True     â”‚     True     â”‚
â”‚ login_completed     â”‚    False     â”‚     True     â”‚     True     â”‚     True     â”‚
â”‚ navigate_to_dockets â”‚    False     â”‚     False    â”‚ Trueâ†’False   â”‚    False     â”‚
â”‚ dockets_nav_completeâ”‚    False     â”‚     False    â”‚     True     â”‚     True     â”‚
â”‚ show_docket_cat...  â”‚    False     â”‚     False    â”‚     True     â”‚    False     â”‚
â”‚ selected_docket     â”‚     None     â”‚     None     â”‚     None     â”‚ "California" â”‚
â”‚ docket_running      â”‚    False     â”‚     False    â”‚     False    â”‚ Trueâ†’False   â”‚
â”‚ completed           â”‚    False     â”‚     False    â”‚     False    â”‚     True     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Key Transitions:
- navigate_to_dockets: False â†’ True (when "Yes, Select Docket" clicked)
                       True â†’ False (after Phase 1 completes)

- dockets_nav_complete: False â†’ True (when Phase 1 completes)

- docket_running: False â†’ True (when state clicked)
                  True â†’ False (after Phase 2 completes)

- completed: False â†’ True (when Phase 2 completes)
```

## Error Handling Flow

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Phase 1 or â”‚
                    â”‚  Phase 2    â”‚
                    â”‚  Executing  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                     â”‚
                â–¼                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  SUCCESS   â”‚        â”‚   ERROR    â”‚
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
               â”‚                     â”‚
               â–¼                     â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ Continue to  â”‚      â”‚ Capture error   â”‚
       â”‚ next phase   â”‚      â”‚ screenshot      â”‚
       â”‚ or show      â”‚      â”‚                 â”‚
       â”‚ completion   â”‚      â”‚ Set result =    â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ "error: ..."    â”‚
                             â”‚                 â”‚
                             â”‚ Cleanup browser â”‚
                             â”‚                 â”‚
                             â”‚ Show error msg  â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Summary

### User Perspective:
1. Start â†’ Login completes
2. Click "Yes, Select Docket" â†’ **Phase 1 runs** â†’ State list appears
3. Click "California" â†’ **Phase 2 runs** â†’ Done!

### System Perspective:
1. Phase 1: `navigate_to_dockets` â†’ Execute â†’ `dockets_nav_complete`
2. Phase 2: `docket_running` â†’ Execute â†’ `completed`

### Benefits:
- âœ… Clear separation of concerns
- âœ… User sees progress at each step
- âœ… Better error isolation
- âœ… Easier debugging with phase-specific screenshots
- âœ… More control over the flow
